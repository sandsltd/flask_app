{% extends "partials/base.html" %}
{% block content %}
<div class="centered-container">
    <div class="dashboard-container">
        <h1>Reset Your Password</h1>
        
        <!-- Flash Message for Errors or Success -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flash-messages">
              {% for category, message in messages %}
                <div class="alert alert-{{ category }}">
                  {{ message }}
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <div class="summary-section">
            <h2>Enter Your New Password</h2>
            <p>Make sure to create a strong password that is at least 8 characters long and includes at least one uppercase letter.</p>
        </div>

        <form action="" method="POST" onsubmit="return validatePassword()">
            <div class="form-group">
                <label for="password">New Password:</label>
                <input type="password" id="password" name="password" required>
                <small>Password must be at least 8 characters long and include at least one uppercase letter.</small>
            </div>
            <input type="submit" value="Reset Password" class="button">
        </form>

        <!-- Link back to Login -->
        <div class="links">
            <p>Remembered your password? <a href="/login" class="button">Go back to Login</a></p>
        </div>
    </div>
</div>

<script>
    function validatePassword() {
        const password = document.getElementById("password").value;
        const errorMessage = document.getElementById("error-message");

        if (!/^(?=.*[A-Z]).{8,}$/.test(password)) {
            alert("Password must be at least 8 characters long and include at least one uppercase letter.");
            return false;
        }
        return true;
    }
</script>

<style>
    /* Base styles ... */

    /* Enhanced Responsive Styles */
    .centered-container {
        display: flex;
        justify-content: center;
        padding: 20px;
        min-height: 100vh;
    }

    .dashboard-container {
        max-width: 600px;
        width: 100%;
        background-color: white;
        padding: 30px;
        border-radius: 10px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        text-align: center;
        margin: auto;
    }

    /* Responsive Adjustments */
    @media (max-width: 768px) {
        .centered-container {
            padding: 15px;
        }

        .dashboard-container {
            padding: 20px;
        }

        h1 {
            font-size: 1.8em;
            margin-bottom: 15px;
        }

        h2 {
            font-size: 1.3em;
        }

        .summary-section {
            margin-bottom: 20px;
        }

        .summary-section p {
            font-size: 0.95em;
            line-height: 1.4;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            font-size: 0.95em;
        }

        .form-group input {
            padding: 12px;
            font-size: 16px;
            min-height: 44px;
        }

        .form-group small {
            font-size: 0.85em;
            line-height: 1.4;
        }

        .button {
            width: 100%;
            padding: 12px;
            min-height: 44px;
            font-size: 1em;
        }
    }

    @media (max-width: 480px) {
        .centered-container {
            padding: 10px;
        }

        .dashboard-container {
            padding: 15px;
            border-radius: 8px;
        }

        h1 {
            font-size: 1.5em;
        }

        h2 {
            font-size: 1.2em;
        }

        .alert {
            padding: 12px;
            font-size: 0.9em;
            margin-bottom: 15px;
        }

        .links {
            margin-top: 15px;
        }

        .links p {
            font-size: 0.9em;
        }
    }

    /* Touch Device Optimization */
    @media (hover: none) {
        input[type="password"],
        .button {
            min-height: 44px;
        }

        .button:active {
            transform: scale(0.98);
        }
    }

    /* iOS Specific Fixes */
    @supports (-webkit-touch-callout: none) {
        input[type="password"] {
            font-size: 16px !important;
        }

        .dashboard-container {
            -webkit-overflow-scrolling: touch;
        }
    }

    /* Enhanced Form Styling */
    .form-group input:focus {
        outline: none;
        border-color: #ff0000;
        box-shadow: 0 0 0 2px rgba(255, 0, 0, 0.1);
    }

    /* Better Alert Messages */
    .alert {
        display: flex;
        align-items: center;
        gap: 10px;
    }

    .alert::before {
        font-family: 'Font Awesome 5 Free';
        font-weight: 900;
    }

    .alert-success::before {
        content: '\f00c';
    }

    .alert-danger::before {
        content: '\f071';
    }

    /* Better Button States */
    .button:disabled {
        opacity: 0.7;
        cursor: not-allowed;
    }

    /* Improved Visual Feedback */
    .form-group input:invalid {
        border-color: #dc3545;
    }

    /* Better Spacing for Error Messages */
    #error-message {
        margin-top: 10px;
        padding: 10px;
        border-radius: 4px;
        font-size: 0.9em;
    }
</style>
{% endblock %}
